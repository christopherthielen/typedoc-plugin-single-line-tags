{"version":3,"file":"component.js","sourceRoot":"","sources":["../../../../../src/lib/utils/options/sources/component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,6CAAmG;AACnG,sCAA8C;AAG9C;IAAqC,mCAAgB;IAArD;;IAuDA,CAAC;IApDa,oCAAU,GAApB;;QACI,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAEpC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW;YAC1B,GAAC,0BAAc,CAAC,KAAK,IAAK,IAAI,CAAC,gBAAgB;YAC/C,GAAC,0BAAc,CAAC,OAAO,IAAG,IAAI,CAAC,kBAAkB;gBACnD,CAAC;IACP,CAAC;IAEO,sCAAY,GAApB,UAAqB,SAAiC;QAClD,IAAM,IAAI,GAAG,SAAS,CAAC,aAAa,CAAC;QACrC,IAAI,CAAC,IAAI,EAAE;YACP,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;YAC/D,OAAO;SACV;QAED,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;YAC3C,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,SAAS,CAAC,qBAAqB,EAAE,CAAC,CAAC;SACjE;QAED,IAAI,SAAS,YAAY,8BAAkB,EAAE;YACzC,KAAkB,UAAyB,EAAzB,KAAA,SAAS,CAAC,aAAa,EAAE,EAAzB,cAAyB,EAAzB,IAAyB,EAAE;gBAAxC,IAAI,KAAK,SAAA;gBACV,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;aAC5B;SACJ;IACL,CAAC;IAEO,yCAAe,GAAvB,UAAwB,SAAiC;QACrD,IAAI,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAClE,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;YACd,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACtC,KAAwB,UAAiC,EAAjC,KAAA,SAAS,CAAC,qBAAqB,EAAE,EAAjC,cAAiC,EAAjC,IAAiC,EAAE;gBAAtD,IAAI,WAAW,SAAA;gBAChB,IAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;aACxD;SACJ;QAED,IAAI,SAAS,YAAY,8BAAkB,EAAE;YACzC,KAAkB,UAAyB,EAAzB,KAAA,SAAS,CAAC,aAAa,EAAE,EAAzB,cAAyB,EAAzB,IAAyB,EAAE;gBAAxC,IAAI,KAAK,SAAA;gBACV,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;aAC/B;SACJ;IACL,CAAC;IAEO,0CAAgB,GAAxB,UAAyB,CAAiB;QACtC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;IACnC,CAAC;IAEO,4CAAkB,GAA1B,UAA2B,CAAiB;QACxC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;IACtC,CAAC;IAtDQ,eAAe;QAD3B,qBAAS,CAAC,EAAC,IAAI,EAAE,mBAAmB,EAAC,CAAC;OAC1B,eAAe,CAuD3B;IAAD,sBAAC;CAAA,AAvDD,CAAqC,0BAAgB,GAuDpD;AAvDY,0CAAe","sourcesContent":["import { Component, ComponentEvent, AbstractComponent, ChildableComponent } from '../../component';\nimport { OptionsComponent } from '../options';\n\n@Component({name: 'options:component'})\nexport class ComponentSource extends OptionsComponent {\n    private knownComponents: string[];\n\n    protected initialize() {\n        this.knownComponents = [];\n        this.addComponent(this.application);\n\n        this.listenTo(this.application, {\n            [ComponentEvent.ADDED]:   this.onComponentAdded,\n            [ComponentEvent.REMOVED]: this.onComponentRemoved\n        });\n    }\n\n    private addComponent(component: AbstractComponent<any>) {\n        const name = component.componentName;\n        if (!name) {\n            this.application.logger.error('Component without name found.');\n            return;\n        }\n\n        if (this.knownComponents.indexOf(name) === -1) {\n            this.knownComponents.push(name);\n            this.owner.addDeclarations(component.getOptionDeclarations());\n        }\n\n        if (component instanceof ChildableComponent) {\n            for (let child of component.getComponents()) {\n                this.addComponent(child);\n            }\n        }\n    }\n\n    private removeComponent(component: AbstractComponent<any>) {\n        let index = this.knownComponents.indexOf(component.componentName);\n        if (index !== -1) {\n            this.knownComponents.splice(index, 1);\n            for (let declaration of component.getOptionDeclarations()) {\n                this.owner.removeDeclarationByName(declaration.name);\n            }\n        }\n\n        if (component instanceof ChildableComponent) {\n            for (let child of component.getComponents()) {\n                this.removeComponent(child);\n            }\n        }\n    }\n\n    private onComponentAdded(e: ComponentEvent) {\n        this.addComponent(e.component);\n    }\n\n    private onComponentRemoved(e: ComponentEvent) {\n        this.removeComponent(e.component);\n    }\n}\n"]}